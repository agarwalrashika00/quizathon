<div class="stats-div">
  <div class="bg-light-grey">
    <b>Participant who has taken the most quiz between: </b>
    <%= form_with url: '/admin/stats', method: :get do |form| %>
      From:
      <%= form.date_field :from %>
      &nbsp; &nbsp;
      To:
      <%= form.date_field :to %>
      &nbsp; &nbsp;
      <%= form.submit 'Show', class: 'btn btn-info'  %>
    <% end %>
  </div>
  <p class='bg-secondary text-light'><%= @stats_manager.user_with_most_quiz&.full_name %></p>
  <br />
  <div class="bg-light-grey font-weight-bold">Highest rated quiz as of now: </div>
  <p class='bg-secondary text-light'><%= @stats_manager.highest_rated_quiz&.title %></p>
  <br />
  <div class="bg-light-grey font-weight-bold">Highest scoring participant along with all quizzes taken by participants in the last 2 months: </div>
  <p class='bg-secondary text-light'><%= @stats_manager.highest_scoring_participant&.full_name %>
    <br />
    <ul class="list-group">
      <b>Quizzes :</b>
      <% @stats_manager.quizzes_of_highest_scoring_participant.each do |quiz| %>
        <li class="list-group-item"><%= quiz.title %></li>
      <% end %>
    </ul>
  </p>
  <br />
  <div class="bg-light-grey font-weight-bold">Most recent participant who has commented on more than 3 quizzes in the current month: </div>
  <p class='bg-secondary text-light'><%= @stats_manager.commenting_user&.full_name %></p>
  <br />
  <div class="bg-light-grey font-weight-bold">All quizzes taken by all the participants in reverse chronological order of participants count along with revenue generated by each quiz:</div>
  <table class="table table-striped pl-0">
    <tr>
      <th class="text-center">Quiz</th>
      <th class="text-center">Participants count</th>
      <th class="text-center">Revenue generated(Rs.)</th>
    </tr>
    <% @stats_manager.reverse_quiz_count_hash.each do |quiz_id, count| %>
      <tr>
        <td class="text-center"><%= Quiz.find_by_id(quiz_id)&.title %></td>
        <td class="text-center"><%= count %></td>
        <td class="text-center"><%= Quiz.find_by_id(quiz_id)&.payments&.size.to_i * 5 %></td>
      </tr>
    <% end %>
  </table>
</div>
