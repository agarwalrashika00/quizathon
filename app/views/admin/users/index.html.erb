<%= link_to '&plus;'.html_safe + ' Create new', new_admin_user_path, class: 'btn btn-dark mt-2 mr-2 float-right border' %>
<h2 class="text-center">Users</h2>
<div class="container-fluid pl-0 pr-0">
  <div class="row h-50 body-row">
    <div class="col-sm-6 mt-2 ransack-col">
      <%= search_form_for [:admin, @q] do |f| %>
        <div class='field'>
          <%= f.label :email_or_first_name_or_last_name_cont, 'Name or email', class: 'mb-0' %>
          <%= f.search_field :email_or_first_name_or_last_name_cont %>
        </div>
      </div>
    </div>
    <div class="row h-50 body-row">
      <div class="col-sm-4 mt-2 ransack-col">
        <%= f.label :role_eq, 'Choose role', class: 'mb-0' %>
        <%= f.select :role_eq, User.roles.to_a.map { |w| [w[0].humanize, w[1]] }, include_blank: true %>
      </div>
      <div class="col-sm-4 mt-2 ransack-col">
        <%= f.label :blocked_true, 'Choose if blocked', class: 'mb-0' %>
        <%= f.select :blocked_true, [[:blocked, 1], [:unblocked, 0]], include_blank: true %>
      </div>
      <div class="col-sm-4 mt-2 ransack-col">
        <%= f.label :confirmed_at_null, 'Choose if confirmed', class: 'mb-0' %>
        <%= f.select :confirmed_at_null, [[:confirmed, 0], [:unconfirmed, 1]], include_blank: true %>
      </div>
    </div>
    <div class="row h-50 body-row">
      <div class="actions mt-2 ml-3">
        <%= link_to "Clear", admin_users_path, class: "btn btn-default border border-dark" %>
        <%= f.submit "Search", class: 'btn btn-primary border' %>
      </div>
    <% end %>
  </div>
  <div class="row justify-content-center body-row">
    <table class = "table table-striped table-hover mt-2">
      <thead class="bg-dark">
        <tr class="h-50 body-row">
          <th><%= sort_link(@q, :first_name, [:first_name, 'last_name asc'], 'Name') %></th>
          <th><%= sort_link(@q, :email) %></th>
          <th><%= sort_link(@q, :last_sign_in_at) %></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |user| %>
          <tr class="h-50 body-row">
            <td>
              <% if user.admin? %>&#128273;<% end %>
              <%= user.first_name.to_s + ' ' + user.last_name.to_s %>
            </td>
            <td><%= user.email %></td>
            <td><%= user.last_sign_in_at %></td>
            <td>
              <%= link_to '&#x270D;'.html_safe, edit_admin_user_path(user), class: 'btn btn-info', title: 'edit' %>
              <%= link_to '&#x2716;'.html_safe, admin_user_path(user), data: {
          turbo_method: :delete, turbo_confirm: 'Are you sure?' }, class: 'btn btn-danger', title: 'delete' %>
              <% if user.blocked %>
                <%= button_to 'unblock', unblock_admin_user_path(id: user.id), method: :patch, class: 'btn btn-default border border-dark', title: 'unblock' %>
              <% else %>
                <%= button_to 'block', block_admin_user_path(id: user.id), method: :patch, class: 'btn btn-default border border-dark', title: 'block' %>
              <% end %>
            </td>
          </tr>
        <% end %>
        <tr class="h-50 body-row bg-light">
          <td class="col-sm-6 mt-2">
          </td>
          <td class="col-sm-6 mt-2 float-right">
            <nav aria-label="Page navigation">
              <ul class="pagination float-right">
                <%= paginate @users %>
              </ul>
            </nav>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
